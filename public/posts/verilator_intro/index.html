<!DOCTYPE html>
<html lang="zh-CN">
    <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Verilator 使用 - 索元的博客</title><meta name="Description" content="Verilator 的简单使用，现在的内容还没什么深度，后期接触的深了会继续更新"><meta property="og:url" content="http://localhost:1313/posts/verilator_intro/">
  <meta property="og:site_name" content="索元的博客">
  <meta property="og:title" content="Verilator 使用">
  <meta property="og:description" content="Verilator 的简单使用，现在的内容还没什么深度，后期接触的深了会继续更新">
  <meta property="og:locale" content="zh_CN">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2024-09-20T04:54:29+00:00">
    <meta property="article:modified_time" content="2025-01-10T10:31:22+00:00">
    <meta property="article:tag" content="Verilator">
    <meta property="article:tag" content="Intro">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Verilator 使用">
  <meta name="twitter:description" content="Verilator 的简单使用，现在的内容还没什么深度，后期接触的深了会继续更新">
<meta name="application-name" content="My cool site">
<meta name="apple-mobile-web-app-title" content="My cool site">
<meta name="referrer" content="no-referrer" /><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="http://localhost:1313/posts/verilator_intro/" /><link rel="prev" href="http://localhost:1313/posts/hyprland_tour/" /><link rel="next" href="http://localhost:1313/posts/cpp_object_life/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="/lib/fontawesome-free/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/fontawesome-free/css/all.min.css"></noscript><link rel="preload" href="/lib/animate/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Verilator 使用",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http:\/\/localhost:1313\/posts\/verilator_intro\/"
        },"genre": "posts","keywords": "Verilator, Intro","wordcount":  865 ,
        "url": "http:\/\/localhost:1313\/posts\/verilator_intro\/","datePublished": "2024-09-20T04:54:29+00:00","dateModified": "2025-01-10T10:31:22+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "suo yuan"
            },"description": "Verilator 的简单使用，现在的内容还没什么深度，后期接触的深了会继续更新"
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>
          const query = window.matchMedia('(prefers-color-scheme: dark)');
          function applyTheme() {
            let theme = window.localStorage?.getItem('theme') || 'auto';
            let isDark = theme === 'dark' || (theme === 'auto' && query.matches);
            document.body.setAttribute('theme', isDark? 'dark' : 'light');
            document.body.setAttribute('cfg-theme', theme);
          }

          applyTheme();
          query.addEventListener('change', applyTheme);
        </script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="索元的博客">SuoYuan&#39;s Blog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/posts/reading"> 索元正在读的文章 </a><a class="menu-item" href="/about"> 关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="索元的博客">SuoYuan&#39;s Blog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/posts/reading" title="">索元正在读的文章</a><a class="menu-item" href="/about" title="">关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Verilator 使用</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel="author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>suo yuan</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-09-20">2024-09-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;865 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;2 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#verilator-介绍">Verilator 介绍</a></li>
    <li><a href="#安装-verilator">安装 Verilator</a></li>
    <li><a href="#使用-verilator">使用 Verilator</a></li>
    <li><a href="#一生一芯-关于-nvboard">一生一芯: 关于 NVBoard</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="verilator-使用">Verilator 使用</h1>
<p>因为报名了<a href="https://ysyx.oscc.cc/" target="_blank" rel="noopener noreffer ">一生一芯</a>，所以简单学习了一下 Verilator 的使用。</p>
<h2 id="verilator-介绍">Verilator 介绍</h2>
<p>Verilator 是开源的 Verilog 仿真测试工具，可以通过编写 C/C++ 完成对 Verilog 的仿真，Verilator 会将 Verilog 转换成 C/C++ 并与测试文件一起编译成程序运行，从而看到仿真结果。</p>
<blockquote>
<p>Verilator is a free and open-source software tool which converts Verilog (a hardware description language) to a cycle-accurate behavioral model in C++ or SystemC. The generated models are cycle-accurate and 2-state; as a consequence, the models typically offer higher performance than the more widely used event-driven simulators, which can model behavior within the clock cycle. Verilator is now used within academic research, open source projects and for commercial semiconductor development. It is part of the growing body of free EDA software.</p>
<p>Verilator 是一款自由的开源软件，可将 Verilog （一种硬件描述语言）转换为 C++ 或 SystemC 中的周期精确行为模型。生成的模型具有周期精确性和状态性；因此，这些模型通常比更广泛使用的事件驱动模拟器提供更高的性能，后者可以在时钟周期内建模行为。Verilator 现在用于学术研究、开源项目和商业半导体开发。它是日益壮大的免费 EDA 软件群体的一部分。</p>
</blockquote>
<h2 id="安装-verilator">安装 Verilator</h2>
<p>你不是 Gentoo Linux 的话，都完全没有看安装这部分的必要，直接从使用部分看起吧。</p>
<p><a href="https://ysyx.oscc.cc/docs/2306/preliminary/0.4.html#stfw-rtfm" target="_blank" rel="noopener noreffer ">一生一芯要求</a>的 Verilator 的版本为 5.008，可惜 <a href="https://github.com/gentoo-mirror/guru" target="_blank" rel="noopener noreffer ">guru</a> 的 <a href="https://github.com/gentoo-mirror/guru/tree/master/sci-electronics/verilator" target="_blank" rel="noopener noreffer ">sci-electronics/verilator</a> 并没有这个版本，我特地本地创建了一个仓库，把 guru 的这个 EBUILD 抄到了那里。</p>
<p>我使用的是 llvm/systemd profile，<code>CXXFLAGS</code> 是 <code>-O3 -pipe -flto=thin -fstack-protector-strong -fstack-clash-protection -fcf-protection=full -D_FORTIFY_SOURCE=3</code>，<code>LDFLAGS</code> 是 <code>-Wl,-O3,-z,now,--as-needed,--lto-O3,--icf=safe,--gc-sections</code>，但是编译的时候内存占用显示直接满了，我尝试降低编译时并行的线程数量，后来告诉我链接出现了问题，我懒得去看到底是哪位的问题了，直接用的 <code>gcc-nolto</code> 这个 env 编译的，我的 gcc-nolto 内容如下:</p>
<div class="code-block code-line-numbers open" style="counter-reset: code-block 0">
    <div class="code-header language-txt">
        <span class="code-title"><i class="arrow fas fa-angle-right fa-fw" aria-hidden="true"></i></span>
        <span class="ellipses"><i class="fas fa-ellipsis-h fa-fw" aria-hidden="true"></i></span>
        <span class="copy" title="Copy to clipboard"><i class="far fa-copy fa-fw" aria-hidden="true"></i></span>
    </div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">CC=&#34;gcc&#34;
</span></span><span class="line"><span class="cl">CXX=&#34;g++&#34;
</span></span><span class="line"><span class="cl">CPP=&#34;gcc -E&#34;
</span></span><span class="line"><span class="cl">AR=&#34;ar&#34;
</span></span><span class="line"><span class="cl">NM=&#34;nm&#34;
</span></span><span class="line"><span class="cl">RANLIB=&#34;ranlib&#34;
</span></span><span class="line"><span class="cl">CFLAGS=&#34;-O3 -march=x86-64-v3 -pipe -fstack-protector-strong -fstack-clash-protection -fcf-protection=full&#34;
</span></span><span class="line"><span class="cl">CXXFLAGS=&#34;${CFLAGS}&#34;
</span></span><span class="line"><span class="cl">LDFLAGS=&#34;-Wl,-O3,-z,now&#34;</span></span></code></pre></div></div>
<blockquote>
<p>2025 年 1 月 10 号</p>
<p>我今天重装了一遍，发现用 GCC 就行，不需要 nolto，我开了 <code>-flto</code> 编译也可以成功，不过 Clang 编译失败</p>
</blockquote>
<h2 id="使用-verilator">使用 Verilator</h2>
<p>可以参考<a href="https://verilator.org/guide/latest/example_cc.html" target="_blank" rel="noopener noreffer ">官方文档给出的例子</a>，还有 <a href="https://soc.ustc.edu.cn/CECS/lab2/verilator/" target="_blank" rel="noopener noreffer ">USTC CECS 2023</a> 中也简单介绍了一点 Verilator 的使用。</p>
<p>你可能有生成波形图的需求，可以参考<a href="https://verilator.org/guide/latest/faq.html" target="_blank" rel="noopener noreffer ">官方文档的 FAQ</a> 中的 <strong>How do I generate waveforms (traces) in C++?</strong> 给出的办法。</p>
<h2 id="一生一芯-关于-nvboard">一生一芯: 关于 NVBoard</h2>
<p>我在编译 NVBoard 总是报错 ld: DSO missing from command line 什么的，我一开始思索是否是因为我系统用的不是 GCC 的 libstdc++ 而是 LLVM 的 libc++ 的原因，但是我一时间没有找到全局使用 clang/llvm 编译工具链的方法。后来通过 AI 了解到一个解决办法: <code>-lc++</code></p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2025-01-10</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on X" data-sharer="x" data-url="http://localhost:1313/posts/verilator_intro/" data-title="Verilator 使用" data-hashtags="Verilator,Intro"><i class="fab fa-x-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Threads" data-sharer="threads" data-url="http://localhost:1313/posts/verilator_intro/" data-title="Verilator 使用"><i class="fab fa-threads fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="http://localhost:1313/posts/verilator_intro/" data-hashtag="Verilator"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="http://localhost:1313/posts/verilator_intro/" data-title="Verilator 使用"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="http://localhost:1313/posts/verilator_intro/" data-title="Verilator 使用"><i data-svg-src="/lib/simple-icons/icons/line.min.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="http://localhost:1313/posts/verilator_intro/" data-title="Verilator 使用"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Diaspora" data-sharer="diaspora" data-url="http://localhost:1313/posts/verilator_intro/" data-title="Verilator 使用" data-description="Verilator 的简单使用，现在的内容还没什么深度，后期接触的深了会继续更新"><i class="fab fa-diaspora fa-fw" aria-hidden="true"></i></a><a href="https://t.me/share/url?url=http%3a%2f%2flocalhost%3a1313%2fposts%2fverilator_intro%2f&amp;text=Verilator%20%e4%bd%bf%e7%94%a8" target="_blank" title="Share on Telegram"><i class="fab fa-telegram fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/verilator/">Verilator</a>,&nbsp;<a href="/tags/intro/">Intro</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/hyprland_tour/" class="prev" rel="prev" title="使用 Hyprland"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>使用 Hyprland</a>
            <a href="/posts/cpp_object_life/" class="next" rel="next" title="译文: C&#43;&#43; 对象的生命周期">译文: C++ 对象的生命周期<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.142.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.3.1-DEV"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2022 - 2025</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">suo yuan</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a>
        </div>

        <div id="fixed-buttons-hidden"><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script src="/lib/katex/katex.min.js"></script><script src="/lib/katex/contrib/auto-render.min.js"></script><script src="/lib/katex/contrib/copy-tex.min.js"></script><script src="/lib/katex/contrib/mhchem.min.js"></script><script>window.config={"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":true,"left":"\\begin{equation}","right":"\\end{equation}"},{"display":true,"left":"\\begin{equation*}","right":"\\end{equation*}"},{"display":true,"left":"\\begin{align}","right":"\\end{align}"},{"display":true,"left":"\\begin{align*}","right":"\\end{align*}"},{"display":true,"left":"\\begin{alignat}","right":"\\end{alignat}"},{"display":true,"left":"\\begin{alignat*}","right":"\\end{alignat*}"},{"display":true,"left":"\\begin{gather}","right":"\\end{gather}"},{"display":true,"left":"\\begin{CD}","right":"\\end{CD}"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":50,"type":"lunr"}};</script><script src="/js/theme.min.js"></script></body>
</html>
